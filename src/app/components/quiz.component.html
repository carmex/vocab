<div class="quiz-container">
  <app-top-nav (back)="onExit()" (settings)="onSettings()"></app-top-nav>

  <div class="progress-section">
    <mat-progress-bar mode="determinate" [value]="progressPercent" class="quiz-progress"></mat-progress-bar>
    <div class="progress-label">{{ progressLabel }}</div>

    <mat-progress-bar mode="determinate" [value]="missedPercent" class="missed-progress"
      color="warn"></mat-progress-bar>
    <div class="missed-label">{{ missedLabel }}</div>
  </div>

  <div class="word-display" *ngIf="currentQuestion">
    <!-- Image/Definition Quiz: Show image -->
    <img *ngIf="isImageQuiz && currentQuestion.wordToQuiz.imageUrl" 
         [src]="currentQuestion.wordToQuiz.imageUrl" 
         alt="Quiz image"
         class="quiz-image">
    <!-- Word/Definition Quiz: Show text -->
    <span *ngIf="!isImageQuiz" [innerHTML]="currentQuestion.wordToQuiz.word | twemoji"></span>
  </div>

  <div class="answer-options" *ngIf="currentQuestion">
    <button *ngFor="let option of currentQuestion.options" mat-raised-button class="answer-button"
      (click)="!feedbackVisible && onAnswer(option)" [ngClass]="{
            'correct': feedbackVisible && option === currentQuestion.correctAnswer,
            'incorrect': feedbackVisible && option === selectedAnswer && option !== currentQuestion.correctAnswer
          }">
      <span [innerHTML]="option | twemoji"></span>
    </button>
  </div>

  <div class="feedback-controls" *ngIf="feedbackVisible">
    <mat-progress-bar *ngIf="!isPaused && timerProgress > 0" mode="determinate" [value]="timerProgress"
      class="timer-progress"></mat-progress-bar>

    <div class="feedback-buttons">
      <button mat-stroked-button color="primary" *ngIf="!isPaused && timerProgress > 0" (click)="onPause()">
        <mat-icon>pause</mat-icon> Pause
      </button>
      <button mat-flat-button color="primary" (click)="onNext()">
        Next <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>
  </div>
</div>